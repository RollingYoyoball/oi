**Portal-->arc068_f**

### Solution

​	作为一只蒟蒻我可能真的没有脑子做这题qwq

​	一开始想的东西是什么。。大力dp啊然后你需要乘一些组合数然后再开心容斥一下之类的玩意==

​	但是实际上。。正解并没有那么多鬼畜的东西

​	首先来分析一下这个玩意有什么性质，不难得到下面几个结论：

1、一旦确定弹出序列中的前$K$个数之后，后面的$n-K$个数可以随便乱排了

2、这$N$个数按从小到大顺序丢进双端队列之后，得到的顺序一定满足（我们用$p$表示$1$所在的位置，用$q_i$表示这个队列中的第$i$个元素，$q_p$就是$1$）：$q_1>q_2>q_3>...>q_p<q_{p+1}<q_{p+2}<...<q_{N}$

​	然后我们现在来考虑一下弹出的顺序（也就是弹出序列$A$中的元素）

​	根据结论1，我们可以只考虑前$K$个元素（实际上应该是前$K-1$个因为第$K$个就是$1$）因为每次我们是从队头或者队尾拎一个元素出来，所以$A1\cdots A_{K-1}$应该可以拆成两个单调递减的子序列（注意是子序列），那么每次新取一个数出来的过程就可以看成是将这个数加到这两个子序列中其中一个的末端

​	我们考虑用两个关键值来表示当前的状态：记$f[i][j]$表示$A$中的前$i$个元素已经确定，其中的最小值是$j$，我们从大到小考虑每个数的位置，那么转移的话我们只要看剩下的数中最大的那个接在哪个子序列的末端

​	具体一点的话就是，当前最小值$j$一定是两个子序列末端的较小值，我们假设末端较小的那个子序列为$a$，较大的那个子序列为$b$，当前加入的数为$x$（显然有$x<a_{min}<b_{min}$）

​	如果说我们将$x$加入$a$的末端，那么当前的最小值应该是